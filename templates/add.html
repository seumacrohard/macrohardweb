<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="https://static.pingendo.com/bootstrap/bootstrap-4.3.1.css">
</head>
{% if data==1 %}
    <script>
        alert("添加成功")
    </script>
{% endif %}
{% if data==0 %}
    <script>
        alert("添加失败，商品或图片名已存在")
    </script>
{% endif %}
<body class="h-100 w-100 justify-content-center align-items-center">
  <div class="py-5 h-100" style="background-image: url('https://static.pingendo.com/cover-bubble-dark.svg'); background-position: right bottom; background-size: cover; background-repeat: repeat; background-attachment: fixed;">
    <div class="container">
      <div class="row">
        <div class="col-md-12"><a class="btn btn-primary" href="login"><i class="fa fa-user fa-fw"></i>登出</a></div>
      </div>
      <div class="row">
        <div class="mx-auto col-md-8 text-center">
          <h1 class="">智简销售管理<br></h1>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 col-6 p-3"><a class="btn btn-secondary btn-lg align-items-center justify-content-center d-flex" href="product">商品管理</a></div>
        <div class="col-lg-6 col-6 p-3">
          <a class="btn btn-secondary btn-lg align-items-center justify-content-center d-flex" href="billList">账单管理</a>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-3 col-6 p-3"></div>
        <div class="col-lg-3 col-6 p-3"></div>
        <div class="col-lg-3 col-6 p-3"></div>
        <div class="col-lg-3 col-6 p-3">
            <input class="btn align-items-center justify-content-center d-flex btn-lg btn-primary" id="btnadd" type="button" value="添加" onclick="addgood()"/>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12 col-6 p-3">
          <div class="table-responsive">
            <table class="table table-striped table-dark">
              <thead></thead>
              <tbody>
               <form class="" id="frm" method="post" enctype="multipart/form-data">
                <tr>
                  <th scope="row" class="text-center">商品ID</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="productId" id="productId"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" class="text-center">商品名称</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="productName" id="productName"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" class="text-center">种类</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="type" id="type"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" class="text-center">库存管理</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="number" id="number"></div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" class="text-center">单价</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="price" id="price"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" class="text-center">生产日期</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="dateofproduce" id="dateofproduce"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" contenteditable="true" style="" class="text-center" >保质日期</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="dateofbad" id="dateofbad"> </div>

                  </td>
                </tr>
                   <tr>
                  <th scope="row" contenteditable="true" style="" class="text-center" >货架位置</th>
                  <td>

                      <div class="form-group"> <input type="text" class="form-control" name="location" id="location"> </div>

                  </td>
                </tr>
                <tr>
                  <th scope="row" style="" class="text-center">图片</th>
                  <td class="p-5">
                      <input type="file" id="myFile" name="myFile" value="" />
                        <img src="${user.user_headimg }" id="myImg"  style="width: 300px;height:300px ;" />
                  </td>
                </tr>
               </form>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="py-5 h-100 justify-content-center" style="background-image: url('https://static.pingendo.com/cover-bubble-dark.svg'); background-position: right bottom; background-size: cover; background-repeat: repeat; background-attachment: fixed;"></div>
  <script src="../static/jquery.js"></script>
  <script type="text/javascript">

      function addgood() {
            var reg1=/^[1-9]\d*$|^0$/;
            var reg2=/^\d+(\.\d{0,2})?$/;
            var reg3=/^[a-z](\d{1,3})$/;
            var date=/(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29)$/
            var proID=$("input[name='productId']").val();
            var proName=$("input[name='productName']").val();
            var ptype=$("input[name='type']").val();
            var pnumber=$("input[name='number']").val();
            var pprice=$("input[name='price']").val();
            var pdateofproduce=$("input[name='dateofproduce']").val();
            var pdateofbad=$("input[name='dateofbad']").val();
            var location=$("input[name='location']").val();
            var file=$("#myFile").val();
          
            if(proID==''||proID=='undefined'||proID==null){
                alert("请输入商品ID");
            }
            else if(!reg1.test(pnumber)){
                alert("商品ID请输入数字");
            }
            else if(proName==''||proName==undefined||proName==null){
                alert("请输入商品名称");
            }
            else if(ptype==''||ptype==undefined||ptype==null){
                alert("请输入商品种类");
            }
            else if(pnumber==''||pnumber==undefined||pnumber==null){
                alert("请输入商品库存数量");
            }
            else if(!reg1.test(pnumber)){
                alert("库存请输入整数");
            }
            else if(!reg2.test(pprice)){
                alert("单价请输入最多两位小数");
            }
            else if( pprice==''||pprice==undefined||pprice==null){
                alert("请输入商品单价");
            }
            else if(!date.test(pdateofproduce)){
                alert("请输入正确的日期格式，如2019-09-05");
            }
            else if(pdateofproduce==''||pdateofproduce==undefined||pdateofproduce==null){
                alert("请输入商品生产日期");
            }
            else if(!date.test(pdateofbad)){
                alert("请输入正确的日期格式，如2019-09-05");
            }
            else if(pdateofbad==''||pdateofbad==undefined||pdateofbad==null){
                alert("请输入商品保质日期");
            }
            else if(pdateofproduce>pdateofbad){
                alert("保质日期需要大于生产日期")
            }
            else if(location==''||location==undefined||location==null){
                alert("请输入商品货架位置");
            }
            else if(!reg3.test(location)){
                alert("请输入正确的货架位置");
            }
            else if(file==''){
                alert("请添加图片");
            }
            else{
                $('#frm').submit();
                alert("添加成功")
            }
      }
      var fileObj = "";
      var imgData = "";

      $("#myFile").change(function () {
        // 构造一个文件渲染对象
        var reader = new FileReader();
        // 得到文件列表数组
        fileObj = $(this)[0].files[0];
        // 拿到文件数据
        reader.readAsDataURL(fileObj);

        reader.onload = function() {
            // 获取文件信息
            imgData = reader.result;
            // 指定位置显示图片
            $("#myImg").attr("src", imgData);

        };
      });
  </script>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" style=""></script>
  <pingendo onclick="window.open('https://pingendo.com/', '_blank')" style="cursor:pointer;position: fixed;bottom: 20px;right:20px;padding:4px;background-color: #00b0eb;border-radius: 8px; width:220px;display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:14px;color:white">Made with Pingendo Free&nbsp;&nbsp;<img src="https://pingendo.com/site-assets/Pingendo_logo_big.png" class="d-block" alt="Pingendo logo" height="16"></pingendo>
</body>

</html>